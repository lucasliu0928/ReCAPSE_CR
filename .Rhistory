# Set theme to allow for plotmath expressions
tt <- ttheme_default(core = list(bg_params=list(fill=c("white", "white")),
fg_params=list(cex=2,fontface="bold")),
colhead = list(fg_params=list(cex=2,col="black"),
bg_params=list(fill="white")))
tbl <- tableGrob(Final_table, rows=NULL ,cols = NULL, theme=tt)
tbl <- gtable_add_grob(tbl,grobs = rectGrob(gp = gpar(fill = NA, lwd = 4)),
t = 1, b = 2, l = 1, r = ncol(tbl))
tbl <- gtable_add_grob(tbl,grobs = rectGrob(gp = gpar(fill = NA, lwd = 4)),
t = 2, b = 2, l = 1, r = ncol(tbl))
tbl$widths <- unit(c(3,3,3,3,1), "inches")
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = 0.1, y = 0, width = 0.5, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = 0.2, y = 0, width = 0.5, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
tbl$widths <- unit(c(2.5,2.5,2.5,2.5,1), "inches")
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = 0.2, y = 0, width = 0.5, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
tbl <- tableGrob(Final_table, rows=NULL ,cols = NULL, theme=tt)
tbl <- gtable_add_grob(tbl,grobs = rectGrob(gp = gpar(fill = NA, lwd = 4)),
t = 1, b = 2, l = 1, r = ncol(tbl))
tbl <- gtable_add_grob(tbl,grobs = rectGrob(gp = gpar(fill = NA, lwd = 4)),
t = 2, b = 2, l = 1, r = ncol(tbl))
tbl$widths <- unit(c(2.5,2.5,2.5,2.5,0.5), "inches")
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = 0.2, y = 0, width = 0.5, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = 0, y = 0, width = 0.5, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = 0.1, y = 0, width = 0.5, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = 0.1, y = 0, width = 0.5, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = 0.12, y = 0, width = 0.5, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
tt <- ttheme_default(core = list(bg_params=list(fill=c("white", "white")),
fg_params=list(cex=2,fontface="bold")),
colhead = list(fg_params=list(cex=2,col="black"),
bg_params=list(fill="white")))
tbl <- tableGrob(Final_table, rows=NULL ,cols = NULL, theme=tt)
tbl <- gtable_add_grob(tbl,grobs = rectGrob(gp = gpar(fill = NA, lwd = 4)),
t = 1, b = 2, l = 1, r = ncol(tbl))
tbl <- gtable_add_grob(tbl,grobs = rectGrob(gp = gpar(fill = NA, lwd = 4)),
t = 2, b = 2, l = 1, r = ncol(tbl))
tbl$widths <- unit(c(2,2.5,2.5,2.5,0.5), "inches")
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = 0.12, y = 0, width = 0.5, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
tbl$widths <- unit(c(2,2.5,2.5,2.5,0.5), "inches")
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = 0.12, y = 0, width = 0.5, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
tbl$widths <- unit(c(2,2,2,2,0.5), "inches")
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = 0.12, y = 0, width = 0.5, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = 0.12, y = 0, width = 0.8, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = 0, y = 0, width = 1, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = -0.1, y = 0, width = 1, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = -0.2, y = 0, width = 1, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
tbl$widths <- unit(c(2,3,2,2,0.5), "inches")
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = -0.2, y = 0, width = 1, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = -0.1, y = 0, width = 1, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
tbl$widths <- unit(c(2,2,2.5,2,0.5), "inches")
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = -0.2, y = 0, width = 1, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = -0.1, y = 0, width = 1, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
tbl$widths <- unit(c(2,2,2.5,2.5,0.5), "inches")
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = -0.1, y = 0, width = 1, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
tbl$widths <- unit(c(2,2.5,2.5,2.5,0.5), "inches")
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = -0.1, y = 0, width = 1, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
tbl$widths <- unit(c(2,3,2.5,2.5,0.5), "inches")
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = -0.1, y = 0, width = 1, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = -0.15, y = 0, width = 1, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
tbl$widths <- unit(c(2,3,2.5,3,0.5), "inches")
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = -0.1, y = 0, width = 1, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = -0.1, y = 0, width = 1, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = -0.15, y = 0, width = 1, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = -0.12, y = 0, width = 1, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
tbl$widths <- unit(c(2,2.8,2.5,3,0.5), "inches")
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = -0.12, y = 0, width = 1, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
tbl$widths <- unit(c(2,2.8,2.8,3,0.5), "inches")
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = -0.12, y = 0, width = 1, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
tbl$widths <- unit(c(2,3,2.8,3,0.5), "inches")
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = -0.12, y = 0, width = 1, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
tbl$widths <- unit(c(2,2.8,2.8,3,0.5), "inches")
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = -0.125, y = 0, width = 1, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
tbl$widths <- unit(c(2,2.8,2.9,3,0.5), "inches")
Fig2 <- ggdraw() +
# draw_plot( plot = Fig1, x = 0, y = 0.5, width = 1, height = 0.5) + # z
draw_plot( plot = Figure2, x = 0, y = 0.1, width = 1, height = 0.8) +  # x
draw_plot( plot = tbl, x = -0.125, y = 0, width = 1, height = .2)  # y
ggsave("/Users/lucasliu/Desktop/Figure2.png", width = 15, height = 10,
units = "in", plot = Fig2,dpi = 1200)
check  <- read.csv("/Users/lucasliu/Desktop/DrChen_Projects/All_AKI_Projects/AKID_Project/Intermediate_data_Dynamic/2021_Data/0114_21_data/DL_input_data/InHOSP/Hourly_interp/Final_outcome_df_Original_NotSampled.csv",stringsAsFactors = F)
which(check$ENCNTR_ID)
check$ENCNTR_ID[1]
gsub("_New[[:digit:]]",",",check$ENCNTR_ID[1])
gsub("_New[[:digit:]]","",check$ENCNTR_ID[1])
check$ENCNTR_ID <- gsub("_New[[:digit:]]","",check$ENCNTR_ID)
unique(check$ENCNTR_ID)
length(unique(check$ENCNTR_ID))
View(check)
check  <- read.csv("/Users/lucasliu/Desktop/DrChen_Projects/All_AKI_Projects/AKID_Project/Intermediate_data_Dynamic/2021_Data/0114_21_data/DL_input_data/InHOSP/Hourly_interp/Final_outcome_df_Original_NotSampled.csv",stringsAsFactors = F)
check$ENCNTR_ID <- gsub("_New[[:digit:]]","",check$ENCNTR_ID)
length(unique(check$ENCNTR_ID))
check  <- read.csv("/Users/lucasliu/Desktop/DrChen_Projects/All_AKI_Projects/AKID_Project/Intermediate_data_Dynamic/2021_Data/0114_21_data/DL_input_data/InHOSP/Hourly_interp/Final_outcome_df_Original_NotSampled.csv",stringsAsFactors = F)
length(unique(check$ENCNTR_ID))
19235 + 4473
check$ENCNTR_ID[1]
check  <- read.csv("/Users/lucasliu/Desktop/DrChen_Projects/All_AKI_Projects/AKID_Project/Intermediate_data_Dynamic/2021_Data/0114_21_data/DL_input_data/InHOSP/Hourly_interp/Final_outcome_df_Original_NotSampled.csv",stringsAsFactors = F)
check$ENCNTR_ID <- gsub("_New[[:digit:]]","",check$ENCNTR_ID)
check$ENCNTR_ID[1]
check$ENCNTR_ID[2]
which(check$ENCNTR_ID == X100061530044)
which(check$ENCNTR_ID == "X100061530044")
unique(check$ENCNTR_ID)
check2 <- unique(check$ENCNTR_ID)
check2 <- as.data.frame(unique(check$ENCNTR_ID))
View(check2)
check$ENCNTR_ID <- gsub(" ,"",check$ENCNTR_ID)
length(unique(check$ENCNTR_ID))
check$ENCNTR_ID[1]
check$ENCNTR_ID[2]
which(check$ENCNTR_ID == "X100061530044")
check2 <- as.data.frame(unique(check$ENCNTR_ID))
check$ENCNTR_ID <- gsub(" ","",check$ENCNTR_ID)
length(unique(check$ENCNTR_ID))
check  <- read.csv("/Users/lucasliu/Desktop/DrChen_Projects/All_AKI_Projects/AKID_Project/Intermediate_data_Dynamic/2021_Data/0114_21_data/DL_input_data/InHOSP/Hourly_interp/Final_outcome_df_Original_NotSampled.csv",stringsAsFactors = F)
gsub("_New[[:digit:]]","",check$ENCNTR_ID[1])
gsub("_New[[:digit:]]","",check$ENCNTR_ID[2])
check$ENCNTR_ID[1]
gsub("_New[[:digit:]]","",X100061530044_New0)
gsub("_New[[:digit:]]","","X100061530044_New0")
gsub("_New[[:digit:]]","","X100061530044_New1")
check$ENCNTR_ID <- gsub("_New[[:digit:]][[:digit:]]","",check$ENCNTR_ID)
check  <- read.csv("/Users/lucasliu/Desktop/DrChen_Projects/All_AKI_Projects/AKID_Project/Intermediate_data_Dynamic/2021_Data/0114_21_data/DL_input_data/InHOSP/Hourly_interp/Final_outcome_df_Original_NotSampled.csv",stringsAsFactors = F)
check$ENCNTR_ID <- gsub("_New[[:digit:]][[:digit:]]","",check$ENCNTR_ID)
length(unique(check$ENCNTR_ID))
check$ENCNTR_ID <- gsub("_New[[:digit:]]","",check$ENCNTR_ID)
length(unique(check$ENCNTR_ID))
data_dir <- "/Users/lucasliu/Desktop/DrChen_Projects/All_AKI_Projects/AKID_Project/Intermediate_data_Dynamic/2021_Data/0114_21_data/More_Sample_Data/HOSP_Stay/Hourly_interp/"
all_interpated_data <- list.dirs(data_dir)
all_interpated_data <- list.files(data_dir)
all_interpated_data[1]
curr_original_pt_Id <- "X315591264"
all_interpated_files<- list.files(data_dir)
which(grepl(curr_original_pt_Id,all_interpated_files)==T)
curr_file_idxes <- which(grepl(curr_original_pt_Id,all_interpated_files)==T)
curr_pts_files <- all_interpated_files[curr_file_idxes]
curr_pts_files[1]
i <- 1
curr_data <- read.csv(paste0(data_dir,curr_pts_files[i]))
View(curr_data)
curr_start <- min(curr_data$Hour_Start_Time)
curr_data <- read.csv(paste0(data_dir,curr_pts_files[i]),stringsAsFactors = F)
curr_start <- min(curr_data$Hour_Start_Time)
curr_start
curr_end <- max(curr_data$Hour_Start_Time)
curr_end
#Read each file, and get start and end time
start_end_time_list <- list(NA)
for (i in 1:length(curr_pts_files)){
curr_data <- read.csv(paste0(data_dir,curr_pts_files[i]),stringsAsFactors = F)
curr_start <- min(curr_data$Hour_Start_Time)
curr_end <- max(curr_data$Hour_Start_Time)
start_end_time_list[[i]] <-c(curr_start,curr_end)
}
curr_all_start_end_time_df <- do.call(rbind, start_end_time_list)
View(curr_all_start_end_time_df)
curr_all_start_end_time_df <- do.call(rbind.data.frame(), start_end_time_list)
curr_all_start_end_time_df <- do.call(rbind.data.frame, start_end_time_list)
colnames(curr_all_start_end_time_df) <- c("Start","End")
curr_pts_files[i]
curr_new_id <- gsub("@inHOSP_Hourly_interp.csv","",curr_pts_files[i])
curr_data <- read.csv(paste0(data_dir,curr_pts_files[i]),stringsAsFactors = F)
new_id_list <- NA
start_end_time_list <- list(NA)
new_id_list <- NA
for (i in 1:length(curr_pts_files)){
curr_new_id <- gsub("@inHOSP_Hourly_interp.csv","",curr_pts_files[i])
curr_data <- read.csv(paste0(data_dir,curr_pts_files[i]),stringsAsFactors = F)
curr_start <- min(curr_data$Hour_Start_Time)
curr_end <- max(curr_data$Hour_Start_Time)
start_end_time_list[[i]] <-c(curr_start,curr_end)
new_id_list <- curr_new_id
}
curr_all_start_end_time_df <- do.call(rbind.data.frame, new_id_list,start_end_time_list)
curr_all_start_end_time_df <- do.call(rbind.data.frame,start_end_time_list)
curr_all_start_end_time_df$ID <- new_id_list
colnames(curr_all_start_end_time_df) <- c("ID","Start","End")
curr_all_start_end_time_df <- do.call(rbind.data.frame,start_end_time_list)
colnames(curr_all_start_end_time_df) <- c("Start","End")
curr_all_start_end_time_df$ID <- new_id_list
curr_pts_files
curr_new_id <- gsub("@inHOSP_Hourly_interp.csv","",curr_pts_files[i])
start_end_time_list <- list(NA)
new_id_list <- NA
for (i in 1:length(curr_pts_files)){
curr_new_id <- gsub("@inHOSP_Hourly_interp.csv","",curr_pts_files[i])
curr_data <- read.csv(paste0(data_dir,curr_pts_files[i]),stringsAsFactors = F)
curr_start <- min(curr_data$Hour_Start_Time)
curr_end <- max(curr_data$Hour_Start_Time)
start_end_time_list[[i]] <-c(curr_start,curr_end)
new_id_list[i] <- curr_new_id
}
curr_all_start_end_time_df <- do.call(rbind.data.frame,start_end_time_list)
colnames(curr_all_start_end_time_df) <- c("Start","End")
curr_all_start_end_time_df$ID <- new_id_list
sample(0,1)
#Get predictions
curr_all_start_end_time_df$Predicted_Y <- sample(c(0,1),replace = T,size = nrow(curr_all_start_end_time_df))
runif(10,0,1)
#Get predictions
curr_all_start_end_time_df$Predicted_Y <- runif(30,0,1)
#Get predictions
curr_all_start_end_time_df$Predicted_Y <- runif(nrow(curr_all_start_end_time_df),0,1)
plot(curr_all_start_end_time_df$End,curr_all_start_end_time_df$Predicted_Y)
data_to_plot <- curr_all_start_end_time_df
curr_all_start_end_time_df$End
# Base plot with date axis
p <- ggplot(data = data_to_plot, aes(x = End, y = Predicted_Y)) +
geom_line(color = "#00AFBB", size = 1)
library(ggplot)
library(ggplot2)
# Base plot with date axis
p <- ggplot(data = data_to_plot, aes(x = End, y = Predicted_Y)) +
geom_line(color = "#00AFBB", size = 1)
p
# Base plot with date axis
p <- ggplot(data = data_to_plot, aes(x = End, y = Predicted_Y,group =1)) +
geom_line(color = "#00AFBB", size = 1)
p
data_to_plot$End
min(data_to_plot$End)
curr_all_start_end_time_df$End
unlist(curr_all_start_end_time_df$End)
as.vector(curr_all_start_end_time_df$End)
as.character(curr_all_start_end_time_df$End)
curr_all_start_end_time_df$End <- as.character(curr_all_start_end_time_df$End)
data_to_plot$End
as.character(curr_all_start_end_time_df$End)
curr_all_start_end_time_df$End
data_to_plot <- curr_all_start_end_time_df
data_to_plot$End)
as.Date(data_to_plot$End)
min(as.Date(data_to_plot$End))
# Set axis limits c(min, max)
min <- min(as.Date(data_to_plot$End))
max <- NA
p + scale_x_date(limits = c(min, max))
library(lubridate)
curr_all_start_end_time_df$End <- ymd_hms(curr_all_start_end_time_df$End)
curr_all_start_end_time_df$End
# Set axis limits c(min, max)
min <- min(as.Date(data_to_plot$End))
max <- NA
p + scale_x_date(limits = c(min, max))
# Base plot with date axis
p <- ggplot(data = data_to_plot, aes(x = End, y = Predicted_Y,group =1)) +
geom_line(color = "#00AFBB", size = 1)
p
# Set axis limits c(min, max)
min <- min(as.Date(data_to_plot$End))
max <- NA
p + scale_x_date(limits = c(min, max))
data_to_plot$End
curr_all_start_end_time_df$End <- ymd_hms(curr_all_start_end_time_df$End)
data_to_plot <- curr_all_start_end_time_df
# Base plot with date axis
p <- ggplot(data = data_to_plot, aes(x = End, y = Predicted_Y,group =1)) +
geom_line(color = "#00AFBB", size = 1)
p
# Set axis limits c(min, max)
min <- min(as.Date(data_to_plot$End))
max <- NA
p + scale_x_date(limits = c(min, max))
# Base plot with date axis
p <- ggplot(data = data_to_plot, aes(x = End, y = Predicted_Y,group =1)) +
geom_point(color = "#00AFBB", size = 1)
p
p + scale_x_date(date_labels = "%b/%Y")
as.Date(data_to_plot$End)
data_to_plot[,"End"] <- as.Date(data_to_plot$End)
data_to_plot$End
# Set axis limits c(min, max)
min <- min(data_to_plot$End)
max <- NA
p + scale_x_date(date_labels = "%b/%Y")
data_to_plot[,"End"] <- as.Date(data_to_plot$End)
# Base plot with date axis
p <- ggplot(data = data_to_plot, aes(x = End, y = Predicted_Y,group =1)) +
geom_point(color = "#00AFBB", size = 1)
p
# Set axis limits c(min, max)
min <- min(data_to_plot$End)
max <- NA
p + scale_x_date(date_labels = "%b/%Y")
data_to_plot[,"End"] <- ymd_hms(data_to_plot$End)
# Base plot with date axis
p <- ggplot(data = data_to_plot, aes(x = End, y = Predicted_Y,group =1)) +
geom_point(color = "#00AFBB", size = 1)
p
ymd_hms(data_to_plot$End)
#Get predictions
curr_all_start_end_time_df$Predicted_Y <- runif(nrow(curr_all_start_end_time_df),0,1)
curr_all_start_end_time_df$End <- ymd_hms(curr_all_start_end_time_df$End)
data_to_plot <- curr_all_start_end_time_df
# Base plot with date axis
p <- ggplot(data = data_to_plot, aes(x = End, y = Predicted_Y,group =1)) +
geom_point(color = "#00AFBB", size = 1)
p
p <- ggplot(data = data_to_plot, aes(x = End, y = Predicted_Y,group =1)) +
geom_point(color = "#00AFBB", size = 1) +
stat_smooth(
color = "#FC4E07", fill = "#FC4E07",
method = "loess")
p
p <- ggplot(data = data_to_plot, aes(x = End, y = Predicted_Y,group =1)) +
geom_point(color = "#00AFBB", size = 1) +
stat_smooth(
color = "#FC4E07", fill = "#FC4E07",
method = "loess")+
ylab("Date")
p
library(ggplot2)
library(lubridate)
plot_risk_func(data_to_plot){
# Base plot with date axis
p <- ggplot(data = data_to_plot, aes(x = End, y = Predicted_Y,group =1)) +
geom_point(color = "#00AFBB", size = 1) +
stat_smooth(
color = "#FC4E07", fill = "#FC4E07",
method = "loess")+
ylab("Date")
return(p)
}
source('~/Desktop/DrChen_Projects/All_AKI_Projects/AKID_Project/AKID_Code/Dynamic_Data_Process_Code/TestCodeFor_DL_server/Package0303/Plot_Predicted_Risk.R', echo=TRUE)
source('~/Desktop/DrChen_Projects/All_AKI_Projects/AKID_Project/AKID_Code/Dynamic_Data_Process_Code/TestCodeFor_DL_server/Package0303/Plot_Predicted_Risk.R', echo=TRUE)
data_dir <- "/Users/lucasliu/Desktop/DrChen_Projects/All_AKI_Projects/AKID_Project/Intermediate_data_Dynamic/2021_Data/0114_21_data/DL_input_data/InHOSP/Hourly_interp/"
all_files <- list.files(data_dir)
i <- 1
curr_data <- read.csv(paste0(data_dir,all_files[i]),stringsAsFactors = F)
View(curr_all_start_end_time_df)
i <- 1
curr_data <- read.csv(paste0(data_dir,all_files[i]),stringsAsFactors = F)
data_dir <- "/Users/lucasliu/Desktop/DrChen_Projects/All_AKI_Projects/AKID_Project/Intermediate_data_Dynamic/2021_Data/0114_21_data/DL_input_data/InHOSP/Hourly_interp/"
all_files <- list.files(data_dir)
i <- 1
curr_data <- read.csv(paste0(data_dir,all_files[i]),stringsAsFactors = F)
View(curr_data)
curr_file <- all_files[i]
curr_file
curr_data <- read.csv(paste0(data_dir,curr_file),stringsAsFactors = F)
min(curr_data)
colnames(curr_data)
min(curr_data[,2:ncol(curr_data)])
min(curr_data[,2:ncol(curr_data)],na.rm = T)
curr_data[,2:ncol(curr_data)
)
View(curr_data)
which(curr_data == 1)
which(curr_data == 1, arr.ind = TRUE)
curr_data[12133 ,32]
curr_data[12133 ,]
quantile(curr_data)
quantile(curr_data[,2:ncol(curr_data)],na.rm = T)
i <- 2
curr_file <- all_files[i]
curr_data <- read.csv(paste0(data_dir,curr_file),stringsAsFactors = F)
quantile(curr_data[,2:ncol(curr_data)],na.rm = T)
quantile(curr_data[,2:ncol(curr_data)],na.rm = T)
setwd("~/Desktop/DrChen_Projects/ReCAPSE_Project/ReCAPSE_Code")
