setwd("~/Desktop/DrChen_Projects/ReCAPSE_Project/ReCAPSE_Code/onHPC")
source("Recapse_Ultility.R")
#######################################################################
##############              Data dir                     ##############
#######################################################################
data_dir <- "/recapse/data/Testing data for UH3 - Dec 16 2020/"
outdir   <- "/recapse/intermediate_data/0_Codes/BeforeClean_UniqueCodes/"
#local
data_dir <- "/Volumes/LJL_ExtPro/Data/ReCAPSE_Data/Testing data for UH3 - Dec 16 2020/"
outdir   <- "/Users/lucasliu/Desktop/DrChen_Projects/ReCAPSE_Project/ReCAPSE_Intermediate_Data/0610_21/0_Codes/BeforeClean_UniqueCodes/"
#######################################################################
############################## Medicaid  ##############################
#######################################################################
#Data
data_df1 <- read.csv(paste0(data_dir,"kcr_medicaid_healthclaims_fb0015.csv"),stringsAsFactors = F)
data_df2 <- read.csv(paste0(data_dir,"KCR_MEDICAID_PHARMCLAIMS_FB0015.csv"),stringsAsFactors = F)
check_df <- data_df1[,HCPCS_proc_cols]
#Codes columns
ICD_diag_cols   <- c("CDE_DIAG_PRIM","CDE_DIAG_2","CDE_DIAG_3","CDE_DIAG_4") #ICD 9 or ICD10
HCPCS_proc_cols <- c("CDE_PROC_PRIM")                                        #HCPCS
AHFS_drug_cols  <- c("CDE_THERA_CLS_AHFS")
NDC_drug_cols   <- c("CDE_NDC")
#PROC: HCPC
check_df <- data_df1[,HCPCS_proc_cols]
colnames(data_df1)
#PROC: HCPC
check_df <- data_df1[,c("study_id",HCPCS_proc_cols]
#PROC: HCPC
check_df <- data_df1[,c("study_id",HCPCS_proc_cols)]
View(check_df)
#PROC: HCPC
HCPC_df_medicaid <- data_df1[,c("study_id",HCPCS_proc_cols)]
#PROC: HCPC
HCPC_df_medicaid <- data_df1[,c("study_id",HCPCS_proc_cols)]
indexes <- which(HCPC_df_medicaid$CDE_PROC_PRIM == "J9355")
Code_check <- HCPC_df_medicaid[indexes,]
#PROC: HCPC
HCPC_df_medicare <- data_df[,c("study_id",HCPCS_proc_cols)]
#Data (Do not use fread, it converts large interge to scitific notation )
data_df <- read.csv(paste0(data_dir,"kcr_medicare_claims_fb0015.csv"),stringsAsFactors = F)
#Code cols
ICD_diag_cols <- paste0("DGNS_CD",seq(1,25))             #ICD9 or ICD10
HCPCS_proc_cols     <- "HCPCS_CD"                        #HCPCS
ICD_procedure_cols <- paste0("PRCDRCD", seq(1,25,1))     #ICD9 or ICD10
NDC_drug_cols <- c("NDC_CD","PROD_SRVC_ID")              #NDC
ICD_diag_cols
length(unique(Code_check$study_id))
